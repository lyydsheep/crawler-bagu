{
  "success": true,
  "data": {
    "id": 43939,
    "name": "<p>联合索引(a,b,c)，在a = 1 and b in (2, 3) and c = 4的情况下是否会索引失效</p>",
    "options": null,
    "answer": "<p>在联合索引 (a,b,c) 下，对于查询条件 “a = 1 and b in (2, 3) and c = 4” 不会出现索引失效的情况。</p>\n<p>联合索引遵循最左前缀原则，也就是在使用联合索引时，MySQL 会从索引的最左边列开始依次使用。在这个查询条件里，首先对 a 列使用了等值查询 “a = 1”，接着对 b 列使用了范围查询 “b in (2, 3)”。虽然 “b in (2, 3)” 属于范围查询，但它并不会导致索引完全失效，只是在使用了 a 和 b 列的索引后，c 列的索引依然可以继续使用。</p>\n<p>MySQL 会先根据 “a = 1” 从联合索引中筛选出 a 列值为 1 的记录，然后在这些记录里，依据 “b in (2, 3)” 进一步筛选出 b 列值为 2 或者 3 的记录，最后再从这些记录中找出 c 列值为 4 的记录。</p>\n<p>所以，在 “a = 1 and b in (2, 3) and c = 4” 这个查询条件下，联合索引 (a,b,c) 能够正常发挥作用，不会出现索引失效的状况。</p>",
    "type": 6,
    "level": 2,
    "freq": 0.0007376444,
    "analysis": "<h3>1. 题目核心</h3>\n<ul>\n  <li><strong>问题</strong>：联合索引(a,b,c)在“a = 1 and b in (2, 3) and c = 4”条件下是否会索引失效。</li>\n  <li><strong>考察点</strong>：\n    <ul>\n      <li>对MySQL联合索引使用规则的理解。</li>\n      <li>范围查询对联合索引使用的影响。</li>\n      <li>索引最左前缀原则的应用。</li>\n    </ul>\n  </li>\n</ul>\n<h3>2. 背景知识</h3>\n<h4>（1）联合索引</h4>\n<p>联合索引是指在表的多个列上创建的索引，MySQL可以利用联合索引的多个列进行查询优化。</p>\n<h4>（2）最左前缀原则</h4>\n<p>MySQL在使用联合索引时遵循最左前缀原则，即查询条件从联合索引的最左边列开始，依次向右匹配，直到遇到范围查询（如>, &#x3C;, BETWEEN, IN等），遇到范围查询后，后续列的索引可能无法被使用。</p>\n<h3>3. 解析</h3>\n<h4>（1）索引使用情况分析</h4>\n<p>在联合索引(a,b,c)和查询条件“a = 1 and b in (2, 3) and c = 4”中：</p>\n<ul>\n  <li>首先，条件“a = 1”满足最左前缀原则，会使用联合索引的第一列a进行索引查找。</li>\n  <li>接着，条件“b in (2, 3)”属于范围查询。根据最左前缀原则，遇到范围查询后，后续列的索引可能无法被使用。所以，虽然有条件“c = 4”，但由于b列使用了范围查询，c列的索引可能不会被使用。</li>\n</ul>\n<h4>（2）索引是否失效判断</h4>\n<p>这里不能简单说索引完全失效，因为联合索引的前两列（a和b）仍然可以被使用。只是第三列c的索引可能无法发挥作用，整体索引的使用效率会受到一定影响。</p>\n<h3>4. 示例代码及验证</h3>\n<pre><code class=\"language-sql\">-- 创建测试表\nCREATE TABLE test_table (\n    a INT,\n    b INT,\n    c INT,\n    PRIMARY KEY (a, b, c)\n);\n\n-- 插入测试数据\nINSERT INTO test_table (a, b, c) VALUES (1, 2, 4), (1, 3, 4), (2, 2, 4);\n\n-- 使用EXPLAIN查看查询执行计划\nEXPLAIN SELECT * FROM test_table WHERE a = 1 AND b IN (2, 3) AND c = 4;\n</code></pre>\n<p>通过<code>EXPLAIN</code>语句的输出结果，可以查看<code>key_len</code>（索引使用的字节数）等信息来判断索引的使用情况。如果<code>key_len</code>只覆盖了a和b列的长度，说明c列的索引未被使用。</p>\n<h3>5. 常见误区</h3>\n<h4>（1）认为索引完全失效</h4>\n<p>\n  误区：看到有范围查询就认为整个联合索引都失效。\n  纠正：联合索引的前几列仍然可以根据最左前缀原则被使用，只是遇到范围查询后，后续列的索引可能无法使用。\n</p>\n<h4>（2）忽略最左前缀原则</h4>\n<p>\n  误区：不考虑联合索引的列顺序和最左前缀原则，认为只要有索引列在查询条件中就都能使用。\n  纠正：要严格按照最左前缀原则来判断索引的使用情况。\n</p>\n<h3>6. 总结回答</h3>\n<p>在联合索引(a,b,c)和查询条件“a = 1 and b in (2, 3) and c = 4”的情况下，索引不会完全失效。根据MySQL的最左前缀原则，联合索引的前两列（a和b）可以被使用，因为条件“a = 1”和“b in (2, 3)”符合最左前缀规则。但由于“b in (2, 3)”属于范围查询，后续列c的索引可能无法被使用，这会在一定程度上影响索引的使用效率。可以通过<code>EXPLAIN</code>语句来查看具体的索引使用情况。</p>",
    "more_ask": "<h3>1. 联合索引使用规则相关</h3>\n<ul>\n  <li><strong>问题</strong>：对于联合索引(a,b,c)，如果查询条件是 a > 1 and b = 2 and c = 3，索引是如何使用的，为什么？\n    <ul>\n      <li><strong>提示</strong>：思考联合索引的最左前缀原则以及范围查询对索引使用的影响。</li>\n    </ul>\n  </li>\n  <li><strong>问题</strong>：若查询语句为 b = 2 and c = 3，没有 a 条件，联合索引(a,b,c)是否会被使用，为什么？\n    <ul>\n      <li><strong>提示</strong>：再次回顾最左前缀原则，判断该查询是否符合索引使用条件。</li>\n    </ul>\n  </li>\n</ul>\n<h3>2. 索引优化相关</h3>\n<ul>\n  <li><strong>问题</strong>：在 a = 1 and b in (2, 3) and c = 4 这个查询中，如果发现索引效率不高，你会考虑哪些优化手段？\n    <ul>\n      <li><strong>提示</strong>：可以从索引本身、查询语句、数据库配置等方面去思考优化方法。</li>\n    </ul>\n  </li>\n  <li><strong>问题</strong>：对于联合索引(a,b,c)，如果经常有 a 和 c 的查询组合，很少涉及 b，是否需要调整索引结构，如何调整？\n    <ul>\n      <li><strong>提示</strong>：根据实际查询需求，考虑索引的列顺序和必要性。</li>\n    </ul>\n  </li>\n</ul>\n<h3>3. 数据库执行计划相关</h3>\n<ul>\n  <li><strong>问题</strong>：如何查看 a = 1 and b in (2, 3) and c = 4 这个查询的执行计划，执行计划中的哪些信息可以帮助判断索引是否有效使用？\n    <ul>\n      <li><strong>提示</strong>：了解查看执行计划的 SQL 语句，以及执行计划中关键列的含义。</li>\n    </ul>\n  </li>\n  <li><strong>问题</strong>：如果执行计划显示索引扫描行数过多，可能是什么原因导致的，如何解决？\n    <ul>\n      <li><strong>提示</strong>：从数据分布、索引选择性等方面去分析原因和解决办法。</li>\n    </ul>\n  </li>\n</ul>\n<h3>4. 索引与数据类型匹配相关</h3>\n<ul>\n  <li><strong>问题</strong>：如果列 a 是整数类型，在查询时写成 a = '1'（字符串形式），对于联合索引(a,b,c)的使用会有什么影响？\n    <ul>\n      <li><strong>提示</strong>：考虑数据类型隐式转换对索引查找的影响。</li>\n    </ul>\n  </li>\n  <li><strong>问题</strong>：当列 b 是日期类型，查询条件为 b in ('2023-01-01', '2023-01-02')，索引使用情况会怎样，需要注意什么？\n    <ul>\n      <li><strong>提示</strong>：关注日期类型在查询时的格式和索引匹配问题。</li>\n    </ul>\n  </li>\n</ul>",
    "mindmap": "mindmap\n  root((联合索引 (a,b,c) 在 “a = 1 and b in (2, 3) and c = 4” 条件下情况))\n    索引不失效\n      遵循最左前缀原则\n      范围查询不致索引完全失效\n    查询过程\n      先按 “a = 1” 筛选\n      再按 “b in (2, 3)” 筛选\n      最后按 “c = 4” 筛选",
    "keynote": "联合索引 (a,b,c)\n查询条件：“a = 1 and b in (2, 3) and c = 4”\n遵循最左前缀原则\n范围查询不致索引完全失效\n查询过程：先筛 a = 1，再筛 b in (2, 3)，最后筛 c = 4\n索引正常发挥作用，不失效",
    "group_id": 13,
    "kps": [
      "索引与查询优化"
    ],
    "years": [
      2024,
      2022
    ],
    "corps": [
      "美团",
      "快手"
    ]
  }
}